--------------------------------------------------------------------------------------------------------------------------------
-- GET CHILD TOPIC IDS
--------------------------------------------------------------------------------------------------------------------------------
-- Given a TopicID, returns the TopicID of each child topic, including nested topics.
--------------------------------------------------------------------------------------------------------------------------------

CREATE
FUNCTION [dbo].[GetChildTopicIDs]
(
	@TopicID		INT
)
RETURNS	@Topics		TABLE
(
	TopicID		INT
)
AS

BEGIN

  ------------------------------------------------------------------------------------------------------------------------------
  -- SET DEFAULTS
  ------------------------------------------------------------------------------------------------------------------------------
  IF (@TopicID IS NULL)
    BEGIN
      SET	@TopicID		= -10
    END

  ------------------------------------------------------------------------------------------------------------------------------
  -- RETRIEVE VALUES
  ------------------------------------------------------------------------------------------------------------------------------
  INSERT
  INTO	@Topics
  SELECT	TopicID
  FROM	Topics
  WHERE	ISNULL(ParentID, -10)	= @TopicID

  ------------------------------------------------------------------------------------------------------------------------------
  -- RETURN
  ------------------------------------------------------------------------------------------------------------------------------
  RETURN

END